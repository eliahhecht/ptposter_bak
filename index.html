<!DOCTYPE html>
<html>
<form id="form">
    <label>AO3 URL (or text URL):
        <input type="text" id="text_url" />
    </label>
    <br />
    <label>Audio URL (optional):
        <input type="text" id="audio_url" />
    </label>
    <br />
    <label>Writers:
        <input type="text" id="writers" />
    </label>
    <br />
    <label>Performers:
        <input type="text" id="performers" />
    </label>
    <br />
    <button type="submit">Go</button>
</form>
<div>
    <textarea id="markup" cols=80 rows=20></textarea>
</div>


<script>
    document.getElementById("form").onsubmit = async (e) => {
        e.preventDefault()
        let url = "https://us-central1-fresh-heuristic-134523.cloudfunctions.net/podtogether-post-generator?"
        let markup = document.getElementById("markup")
        try {
            markup.textContent = "Loading..."
            let dwContent = await fetch(url + new URLSearchParams({
                text_url: document.getElementById("text_url").value,
                audio_url: document.getElementById("audio_url").value,
                writers: document.getElementById("writers").value,
                performers: document.getElementById("performers").value
            }))
            markup.textContent = await dwContent.text()
        } catch (err) {
            alert(err)
            markup.textContent = ""
        }
    }
</script>


</html>
